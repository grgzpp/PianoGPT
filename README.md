# PianoGPT

PianoGPT is a generative neural network designed to create piano music using a GPT-style model, which is an autoregressive decoder-only transformer. It can compose music from scratch or generate variations of existing pieces, with a particular focus on classical compositions.

This project was built on the basis of [nanoGPT](https://github.com/karpathy/nanoGPT), an open-source project by Andrej Karpathy. My gratitude for what he does for the open source community of machine learning.
The model was trained on the [GiantMIDI-Piano dataset](https://github.com/bytedance/GiantMIDI-Piano), a comprehensive collection of piano compositions by thousands of composers.
It also relies on the [MidiTok](https://github.com/Natooz/MidiTok) tokenizer for MIDI files, which does a really good job.

## Features

- **Music Generation**: Generate original piano compositions or extend existing pieces.
- **Fine-Tuning**: Customizable to specific composers or styles (e.g., Beethoven).
- **MIDI File Support**: Handles MIDI format for input and output audio files.
- **Scalable Architecture**: Easily train larger or deeper models by tweaking parameters (subject to computational resources).

## Overview

- **`nanogpt_model.py`**  
  Contains the GPT-style neural network implementation, based on nanoGPT.

- **`train.ipynb`**  
  Jupyter notebook for training the model on the GiantMIDI-Piano dataset. Includes pre-training and fine-tuning stages.

- **`generate.ipynb`**  
  Jupyter notebook for generating music. Supports both free-form generation and variation on existing pieces.

- **`dataset_prepare.ipynb`**  
  Jupyter notebook for preparing the dataset. Converts raw MIDI files into a format suitable for training.

### Audio Files
- **`audio_files/`**  
  - Contains sample input MIDI files and the output generated by the model.  
  - Includes examples of both generic music generation and composer-specific fine-tuned variations (e.g., Beethoven’s *Für Elise*).


## Quick Start

Follow these steps to set up and use PianoGPT:

### 1. Clone the Repository
```bash
git clone https://github.com/grgzpp/PianoGPT
cd PianoGPT
```

### 2. Install Dependencies
Make sure you have Python 3.8+ installed. Install the required libraries using:
```bash
pip install -r requirements.txt
```
Installation of PyTorch with CUDA is highly recommended.

### 3.1. Prepare the Dataset and Train the Model
Run the `dataset_prepare.ipynb` notebook to process the *GiantMIDI-Piano dataset* or your own MIDI files:
```
jupyter notebook dataset_prepare.ipynb
```

Use the `train.ipynb` notebook to pre-train the model on a large dataset and fine-tune it for specific styles.
```
jupyter notebook train.ipynb
```

### 3.2. Download the model checkpoint
Download the model checkpoint, available as a [pre-trained](https://drive.google.com/file/d/1MRfJitQ33Sz7N0gFXt1cLjz8yV7AHdEK/view?usp=sharing) version or [fine-tuned](https://drive.google.com/file/d/1C-FGtPbFTahOg-K3iI3yiIFhB6q4eBSW/view?usp=sharing) to Beethoven’s pieces.

### 4. Generate Music
Run the `generate.ipynb` notebook to create music. You can:
- Generate music from scratch.
- Provide a few seconds of an existing piece for the model to continue.

```
jupyter notebook generate.ipynb
```


## Examples

### 1. Original Music Generation
- Input: [1] (the start token only), or any other allowed token.  
- Output: An entirely new piano composition.

### 2. Variations on Existing Music
- Input: First 10 seconds of Beethoven’s *Für Elise*.  
- Output: A model-generated continuation.

Listen to examples in the **`audio_files/`** folder.


## Scalability

PianoGPT can be scaled up by:
1. Increasing the model’s size (e.g., more layers, augmented block size, or larger embeddings in `nanogpt_model.py`).
2. Training on larger datasets or for longer durations.

However, both options require additional computational resources.


## Future Plans

- **Raw Audio Support**: Enable the model to handle raw audio instead of MIDI for richer sound quality.  
- **Efficient Scaling**: Optimize for larger models and datasets while managing resource constraints.


## Contributing

Contributions are welcome! If you have suggestions for improvements or ideas for new features, feel free to submit a pull request or open an issue.


## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

